Options -MultiViews
RewriteEngine On

#Improved SEO rules
AddDefaultCharset UTF-8
DefaultLanguage es-ES

Header set X-Robots-Tag "noindex, noarchive, nosnippet"
Header set Cache-Control "max-age=300, public"

<FilesMatch ".(flv|gif|jpg|jpeg|png|ico|swf|js|css|pdf)$">
	Header set Cache-Control "max-age=28800"
</FilesMatch>

#HTTP Error redirections
ErrorDocument 404 /daw/404/
RewriteRule ^404[/]?$ ./index.php?ctl=404 [L]

#Main pages
RewriteRule ^admin[/]?$ ./index.php?ctl=admin [L]
RewriteRule ^projects[/]?$ ./index.php?ctl=projects [L]
RewriteRule ^projects/rows/([0-9]+)/page/([0-9]+)[/]?$ ./index.php?ctl=projects&rowNumber=$1&pageIndex=$2 [L]
RewriteRule ^projects/rows/([0-9]+)/page/([0-9]+)/search/([^/]+)[/]?$ ./index.php?ctl=projects&rowNumber=$1&pageIndex=$2&search=$3 [L]
RewriteRule ^about[/]?$ ./index.php?ctl=about [L]

#Signin
RewriteRule ^signin[/]?$ ./index.php?ctl=signin&login=test [L]
RewriteRule ^signout[/]?$ ./index.php?ctl=signout [L]
RewriteRule ^signup[/]?$ ./index.php?ctl=signup [L]

#Errors
RewriteRule ^maintenance[/]?$ ./index.php?ctl=maintenance [L]
RewriteRule ^access[/]?$ ./index.php?ctl=access [L]
RewriteRule ^error[/]?$ ./index.php?ctl=error [L]
RewriteRule ^execution-error[/]?$ ./index.php?ctl=error&message=No_se_ha_podido_ejecutar_la_acci%C3%B3n_correspondiente [L]
RewriteRule ^no-action[/]?$ ./index.php?ctl=error&message=La_acci%C3%B3n_no_se_ha_podido_encontrar_o_no_est%C3%A1_disponible_en_estos_momentos [L]
RewriteRule ^notsigned[/]?$ ./index.php?ctl=notsigned [L]
RewriteRule ^notuseragent[/]?$ ./index.php?ctl=notuseragent [L]

#Project Rules
RewriteRule ^projects/id/([^/]+)[/]?$ ./index.php?ctl=project&id=$1 [L]
#Tabs
RewriteRule ^projects/id/([^/]+)/overview/assigned-tasks[/]?$ ./index.php?ctl=project&id=$1&tabName=overview&subView=assingedTasks [L]
RewriteRule ^projects/id/([^/]+)/([^/]+)[/]?$ ./index.php?ctl=project&id=$1&tabName=$2 [L]
#Pagination dashboards
RewriteRule ^projects/id/([^/]+)/dashboards/rows/([0-9]+)/page/([0-9]+)[/]?$ ./index.php?ctl=project&id=$1&tabName=dashboards&rowNumber=$2&pageIndex=$3 [L]
RewriteRule ^projects/id/([^/]+)/dashboards/rows/([0-9]+)/page/([0-9]+)/search/([^/]+)[/]?$ ./index.php?ctl=project&id=$1&tabName=dashboards&rowNumber=$2&pageIndex=$3&search=$4 [L]
#Pagination collaborators
RewriteRule ^projects/id/([^/]+)/collaborators/rows/([0-9]+)/page/([0-9]+)[/]?$ ./index.php?ctl=project&id=$1&tabName=collaborators&rowNumber=$2&pageIndex=$3 [L]
RewriteRule ^projects/id/([^/]+)/collaborators/rows/([0-9]+)/page/([0-9]+)/search/([^/]+)[/]?$ ./index.php?ctl=project&id=$1&tabName=collaborators&rowNumber=$2&pageIndex=$3&search=$4 [L]
#Empty params redirection
RewriteRule ^projects/id[/]?$ ./index.php?ctl=projects [L]

#Task list
RewriteRule ^projects/id/([^/]+)/tasklist/id/([^/]+)[/]?$ ./index.php?ctl=project&id=$1&element=tasks&secondaryId=$2 [L]
#Empty params redirection
RewriteRule ^projects/id/([^/]+)/tasklist[/]?$ ./index.php?ctl=project&id=$1 [L]
RewriteRule ^projects/id/([^/]+)/tasklist/id[/]?$ ./index.php?ctl=project&id=$1 [L]

#Dashboard
RewriteRule ^projects/id/([^/]+)/dashboards/([^/]+)[/]?$ ./index.php?ctl=project&id=$1&element=tasks&secondaryId=$2 [L]
RewriteRule ^projects/id/([^/]+)/dashboards/([^/]+)/change-image[/]?$ ./index.php?ctl=project&id=$1&element=tasks&secondaryId=$2&view=changeImage [L]
RewriteRule ^projects/id/([^/]+)/dashboards/([^/]+)/json[/]?$ ./index.php?ctl=project&id=$1&element=tasks&secondaryId=$2&view=json [L]
RewriteRule ^projects/id/([^/]+)/dashboards/([^/]+)/task/id/([0-9]+)[/]?$ ./index.php?ctl=project&id=$1&element=tasks&secondaryId=$2&taskId=$3 [L]
#Empty params redirection
RewriteRule ^projects/id/([^/]+)/dashboards/id[/]?$ ./index.php?ctl=project&id=$1 [L]

#Diary
RewriteRule ^projects/id/([^/]+)/diary[/]?$ ./index.php?ctl=project&id=$1&tabName=diary [L]
RewriteRule ^projects/id/([^/]+)/diary/date[/]?$ ./index.php?ctl=project&id=$1&tabName=diary [L]
RewriteRule ^projects/id/([^/]+)/diary/date/([^/]+)[/]?$ ./index.php?ctl=project&id=$1&tabName=diary&date=$2 [L]

#Profile
RewriteRule ^profile[/]?$ ./index.php?ctl=profile [L]
RewriteRule ^profile/change-pass[/]?$ ./index.php?ctl=profile&tabName=pass [L]
RewriteRule ^profile/change-image[/]?$ ./index.php?ctl=profile&tabName=image [L]
RewriteRule ^profile/reset-profile-image[/]?$ ./index.php?ctl=profile&reset=profileImage [L]
RewriteRule ^profile/reset-background-image[/]?$ ./index.php?ctl=profile&reset=bgImage [L]
RewriteRule ^profile/([^/]+)[/]?$ ./index.php?ctl=profile&username=$1 [L]

#Admin
RewriteRule ^admin[/]?$ ./index.php?ctl=admin [L]
RewriteRule ^admin/new-route[/]?$ ./index.php?ctl=addNewRoute [L]
RewriteRule ^admin/access-level[/]?$ ./index.php?ctl=accessLevel [L]
RewriteRule ^admin/popo[/]?$ ./index.php?ctl=createPOPOfromDatabase [L]
RewriteRule ^admin/download-database[/]?$ ./index.php?ctl=getDatabase [L]
RewriteRule ^admin/testing[/]?$ ./index.php?ctl=test [L]
RewriteRule ^admin/get-data-from-table/([^/]+)[/]?$ ./index.php?ctl=getDataFromTable&tableName=$1 [L]

#rutasAjax
RewriteRule ^ajax/([^/]+)[/]?$ ./index.php?ctl=$1 [L]